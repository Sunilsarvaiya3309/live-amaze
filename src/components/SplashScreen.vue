<script setup>
import { ref, onMounted } from "vue";
import { gsap } from "gsap";

const pathEl = ref(null);
const visible = ref(true);
const leftCurtain = ref(null);
const rightCurtain = ref(null);

onMounted(() => {
  const path = pathEl.value;

  // Ensure the path and splash exist
  if (!path) return;

  // Prepare stroke drawing
  const length = path.getTotalLength();
  gsap.set(path, {
    strokeDasharray: length,
    strokeDashoffset: length,
    opacity: 0.1,
  });

  const tl = gsap.timeline({
    defaults: { ease: "power4.inOut" },
  });
  // Animate stroke draw
  // Step 1: Curtain animations
  tl.to(leftCurtain.value, {
    x: "-100%",
    duration: 2.5,
  })
    .to(
      rightCurtain.value,
      {
        x: "100%",
        duration: 2.5,
      },
      "<" // run both curtains at the same time
    )
    // Step 2: Stroke draw animation (after curtains complete)
    .to(path, {
      strokeDashoffset: 0,
      duration: 5,
      delay: -1.9,
      opacity: 1,
      ease: "power2.inOut",
      onComplete: () => {
        // Step 3: Hide splash screen only after path draw is complete
        visible.value = false;
      },
    });
});
</script>
<template>
  <div
    v-if="visible"
    class="fixed inset-0 z-50 bg-black flex items-center justify-center"
  >
    <svg
      class="w-full h-auto text-center"
      viewBox="-7 0 398 65"
      xmlns="http://www.w3.org/2000/svg"
      stroke="yellow"
      stroke-width="2"
      fill="black"
    >
      <!-- SVG Path converted from "AMAZE." -->
      <path
        ref="pathEl"
        d="M0 48.12L0 45.83Q0.71 45.83 1.93 45.40Q3.15 44.97 4.61 44.07Q6.08 43.14 7.67 41.71Q9.25 40.28 10.72 38.21L25.90 16.60L50.54 16.60L63.84 37.67Q65.23 39.87 66.87 41.42Q68.51 42.97 70.12 43.95Q71.70 44.92 73.11 45.37Q74.51 45.83 75.46 45.83L75.46 48.12L28.56 48.12L28.56 45.83Q30.05 45.83 31.41 45.29Q32.76 44.75 33.62 43.68Q34.47 42.60 34.47 41.02Q34.47 40.48 34.23 39.67L14.77 39.67Q14.55 40.26 14.55 40.80Q14.55 42.43 15.42 43.55Q16.28 44.68 17.64 45.25Q18.99 45.83 20.48 45.83L20.48 48.12L0 48.12M16.55 36.28L32.76 36.28Q32.25 35.30 31.57 34.02Q30.88 32.74 29.96 31.10Q29.03 29.47 27.87 27.44Q26.71 25.42 25.24 22.92Q23.58 25.44 22.22 27.49Q20.85 29.54 19.78 31.20Q18.73 32.84 17.92 34.08Q17.11 35.33 16.55 36.28ZM111.45 49.00L94.04 27.42L94.04 31.81Q94.04 32.76 94.07 33.68Q94.09 34.59 94.14 35.47Q94.21 37.23 94.56 38.76Q94.90 40.28 95.58 41.55Q96.22 42.77 97.39 43.73Q98.54 44.63 100.24 45.19Q101.95 45.75 104.39 45.83L104.39 48.12L78.52 48.12L78.52 45.83Q83.40 45.65 86.13 44.35Q88.87 43.04 89.98 40.04Q91.09 37.04 91.09 31.81Q91.09 27.81 90.34 25.28Q89.60 22.75 88.01 21.34Q86.45 19.90 84.00 19.40Q81.54 18.90 78.17 18.90L78.17 16.60L114.11 16.60L122.27 25.98L127.98 16.60L163.72 16.60L163.72 18.90Q160.38 18.90 157.98 19.42Q155.59 19.95 154.09 21.34Q152.59 22.73 151.88 25.26Q151.17 27.78 151.17 31.81Q151.17 37.08 152.28 40.09Q153.39 43.09 156.13 44.37Q158.86 45.65 163.72 45.83L163.72 48.12L117.63 48.12L117.63 45.83Q120.09 45.75 121.78 45.21Q123.51 44.68 124.65 43.75Q125.78 42.82 126.46 41.55Q127.51 39.58 127.75 37.06Q127.98 34.55 127.98 31.81L127.98 22.61L111.45 49.00ZM166.77 48.12L166.77 45.83Q167.48 45.83 168.70 45.40Q169.92 44.97 171.39 44.07Q172.85 43.14 174.44 41.71Q176.03 40.28 177.49 38.21L192.68 16.60L217.31 16.60L230.62 37.67Q232.01 39.87 233.64 41.42Q235.28 42.97 236.89 43.95Q238.48 44.92 239.88 45.37Q241.28 45.83 242.24 45.83L242.24 48.12L195.34 48.12L195.34 45.83Q196.83 45.83 198.18 45.29Q199.54 44.75 200.39 43.68Q201.25 42.60 201.25 41.02Q201.25 40.48 201.00 39.67L181.54 39.67Q181.32 40.26 181.32 40.80Q181.32 42.43 182.19 43.55Q183.06 44.68 184.41 45.25Q185.77 45.83 187.26 45.83L187.26 48.12L166.77 48.12M183.33 36.28L199.54 36.28Q199.02 35.30 198.34 34.02Q197.66 32.74 196.73 31.10Q195.80 29.47 194.64 27.44Q193.48 25.42 192.02 22.92Q190.36 25.44 188.99 27.49Q187.62 29.54 186.55 31.20Q185.50 32.84 184.69 34.08Q183.89 35.33 183.33 36.28ZM245.17 48.12L245.17 45.48Q246.68 45.48 248.44 44.35Q250.20 43.21 252.93 40.50Q253.91 39.58 255.07 38.37Q256.23 37.16 257.59 35.69Q260.30 32.76 263.98 28.70Q267.65 24.63 272.53 19.17Q270.36 19.19 268.43 19.23Q266.50 19.26 264.84 19.36Q261.50 19.53 259.02 19.92Q256.54 20.31 254.86 21.02Q253.20 21.70 252.12 22.80Q251.10 23.88 250.65 25.40Q250.20 26.93 250.20 28.98L249.83 28.98L249.02 29.00L247.85 29.00L247.85 16.60L308.11 16.60L308.11 18.90Q306.49 18.90 304.90 20.12Q303.30 21.34 300.88 23.95Q299.12 25.88 296.57 28.82Q294.02 31.76 290.45 35.84Q288.67 37.87 286.56 40.25Q284.45 42.63 282.01 45.36Q288.50 45.29 293.07 44.89Q297.63 44.48 300.48 43.48Q303.32 42.48 304.63 40.61Q305.93 38.75 305.93 35.74L307.08 35.74L308.20 35.72L308.20 48.12L245.17 48.12ZM312.23 48.12L312.23 45.83Q317.11 45.65 319.85 44.35Q322.58 43.04 323.69 40.04Q324.80 37.04 324.80 31.81Q324.80 27.95 324.13 25.38Q323.46 22.80 321.90 21.34Q320.87 20.41 319.48 19.87Q318.09 19.34 316.28 19.12Q314.48 18.90 312.23 18.90L312.23 16.60L380.42 16.60Q381.05 19.68 381.36 23.29Q381.67 26.90 381.67 29.83L379.10 29.83Q377.47 27.39 374.32 25.39Q371.17 23.39 367.16 21.97Q363.16 20.53 358.79 19.78Q354.42 19.02 350.20 19.02L350.20 31.37Q351.56 30.98 353.86 30.05Q356.15 29.13 358.86 27.88Q361.55 26.64 363.43 25.68Q365.31 24.73 365.89 24.32Q366.31 26.15 366.43 28.58Q366.55 31.01 366.55 32.84Q366.55 34.59 366.39 36.88Q366.24 39.16 365.89 40.67Q365.26 40.28 363.31 39.29Q361.35 38.31 358.76 37.11Q356.30 35.99 353.97 35.01Q351.64 34.03 350.20 33.64L350.20 45.70Q354.30 45.70 359.23 44.86Q364.16 44.02 368.95 42.53Q372.00 41.55 374.63 40.34Q377.27 39.14 379.15 37.74Q381.03 36.35 381.79 34.89L384.35 34.89Q384.35 37.82 384.05 41.43Q383.74 45.04 383.11 48.12L312.23 48.12Z"
        stroke-linecap="round"
        stroke-linejoin="round"
      />
    </svg>
    <div
      ref="leftCurtain"
      class="absolute left-0 top-0 h-full w-1/2 bg-yellow-500 z-[100]"
    ></div>
    <div
      ref="rightCurtain"
      class="absolute right-0 top-0 h-full w-1/2 bg-yellow-500 z-[100]"
    ></div>
  </div>
</template>
